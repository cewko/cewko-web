<div class="visitors-content">
  <div class="visitors-row">
    <span class="visitors-label">all-time (oct. `25)</span>
    <span class="visitors-value"
      >: <span class="visitor-number" data-value="{{ total_visits }}"></span
    ></span>
  </div>
  <div class="visitors-row">
    <span class="visitors-label">unique people</span>
    <span class="visitors-value"
      >: <span class="visitor-number" data-value="{{ unique_visitors }}"></span
    ></span>
  </div>
</div>

<script>
  (function () {
    function formatAndColorVisitors() {
      const visitorNumbers = document.querySelectorAll(".visitor-number");

      visitorNumbers.forEach((element) => {
        const value = parseInt(element.getAttribute("data-value")) || 0;

        // Pad to 10 digits with leading zeros for XXX.XXXX.XXX format
        const paddedValue = value.toString().padStart(10, "0");

        // Split into groups: XXX.XXXX.XXX (3-4-3)
        const part1 = paddedValue.substring(0, 3);
        const part2 = paddedValue.substring(3, 7);
        const part3 = paddedValue.substring(7, 10);

        // Find where the actual number starts (first non-zero digit)
        let numberStarted = false;
        let html = "";

        // Part 1 (3 digits)
        for (let digit of part1) {
          if (!numberStarted && digit !== "0") {
            numberStarted = true;
          }
          const colorClass = numberStarted ? "non-zero" : "";
          html += `<span class="visitor-digit ${colorClass}">${digit}</span>`;
        }
        html += '<span class="visitor-dot">.</span>';

        // Part 2 (4 digits)
        for (let digit of part2) {
          if (!numberStarted && digit !== "0") {
            numberStarted = true;
          }
          const colorClass = numberStarted ? "non-zero" : "";
          html += `<span class="visitor-digit ${colorClass}">${digit}</span>`;
        }
        html += '<span class="visitor-dot">.</span>';

        // Part 3 (3 digits)
        for (let digit of part3) {
          if (!numberStarted && digit !== "0") {
            numberStarted = true;
          }
          const colorClass = numberStarted ? "non-zero" : "";
          html += `<span class="visitor-digit ${colorClass}">${digit}</span>`;
        }

        element.innerHTML = html;
      });
    }

    // Run on load
    formatAndColorVisitors();
  })();
</script>
